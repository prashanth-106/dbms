--LIBRARY:-
CREATE TABLE PUBLISHER
(NAME VARCHAR (20) PRIMARY KEY, 
PHONE INTEGER,
ADDRESS VARCHAR (20));
 
CREATE TABLE BOOK (
    BOOK_ID INTEGER PRIMARY KEY,
    TITLE VARCHAR(20),
    PUB_YEAR VARCHAR(20),
    PUBLISHER_NAME VARCHAR(50), -- Assuming the length of the publisher name is less than or equal to 50 characters
    FOREIGN KEY (PUBLISHER_NAME) REFERENCES PUBLISHER(NAME) ON DELETE CASCADE
);
 
CREATE TABLE BOOK_AUTHORS (
    AUTHOR_NAME VARCHAR(20),
    BOOK_ID INTEGER,
    PRIMARY KEY (BOOK_ID, AUTHOR_NAME),
    FOREIGN KEY (BOOK_ID) REFERENCES BOOK(BOOK_ID) ON DELETE CASCADE
);
 
 
CREATE TABLE LIBRARY_BRANCH (
    BRANCH_ID INTEGER PRIMARY KEY,
    BRANCH_NAME VARCHAR(50),
    ADDRESS VARCHAR(50)
);
 
 
CREATE TABLE BOOK_COPIES (
    NO_OF_COPIES INTEGER,
    BOOK_ID INTEGER,
    BRANCH_ID INTEGER,
    PRIMARY KEY (BOOK_ID, BRANCH_ID),
    FOREIGN KEY (BOOK_ID) REFERENCES BOOK (BOOK_ID) ON DELETE CASCADE,
    FOREIGN KEY (BRANCH_ID) REFERENCES LIBRARY_BRANCH (BRANCH_ID) ON DELETE CASCADE
);
 
 
CREATE TABLE CARD
(CARD_NO INTEGER PRIMARY KEY);
 
 
CREATE TABLE BOOK_LENDING (
    DATE_OUT DATE,
    DUE_DATE DATE,
    BOOK_ID INTEGER,
    BRANCH_ID INTEGER,
    CARD_NO INTEGER,
    PRIMARY KEY (BOOK_ID, BRANCH_ID, CARD_NO),
    FOREIGN KEY (BOOK_ID) REFERENCES BOOK (BOOK_ID) ON DELETE CASCADE,
    FOREIGN KEY (BRANCH_ID) REFERENCES LIBRARY_BRANCH (BRANCH_ID) ON DELETE CASCADE,
    FOREIGN KEY (CARD_NO) REFERENCES CARD (CARD_NO) ON DELETE CASCADE
);
--INSERTION:
 
INSERT INTO PUBLISHER VALUES ('MCGRAW-HILL', 99890, 'BANGALORE');
INSERT INTO PUBLISHER VALUES ('PEARSON', 98890, 'NEWDELHI');
INSERT INTO PUBLISHER VALUES ('RANDOM HOUSE', 74556, 'HYDRABAD');
INSERT INTO PUBLISHER VALUES ('HACHETTE LIVRE', 89708, 'CHENAI');
INSERT INTO PUBLISHER VALUES ('GRUPO PLANETA', 77561,'BANGALORE');
 
 
INSERT INTO BOOK VALUES (1, 'DBMS', 'JAN-2017', 'MCGRAW-HILL');
INSERT INTO BOOK VALUES (2, 'ADBMS', 'JUN-2016', 'MCGRAW-HILL');
INSERT INTO BOOK VALUES (3, 'CN', 'SEP-2016', 'PEARSON');
INSERT INTO BOOK VALUES (4, 'CG', 'SEP-2015', 'GRUPO PLANETA');
INSERT INTO BOOK VALUES (5, 'OS', 'MAY-2016', 'PEARSON');
 
 
INSERT INTO BOOK_AUTHORS VALUES ('NAVATHE', 1);
INSERT INTO BOOK_AUTHORS VALUES ('NAVATHE', 2);
INSERT INTO BOOK_AUTHORS VALUES ('TANENBAUM', 3);
INSERT INTO BOOK_AUTHORS VALUES ('EDWARD ANGEL', 4);
INSERT INTO BOOK_AUTHORS VALUES ('GALVIN', 5);
 
 
INSERT INTO LIBRARY_BRANCH VALUES (10, 'RR NAGAR', 'BANGALORE');
INSERT INTO LIBRARY_BRANCH VALUES (11, 'RNSIT', 'BANGALORE');
INSERT INTO LIBRARY_BRANCH VALUES (12, 'RAJAJI NAGAR', 'BANGALORE');
INSERT INTO LIBRARY_BRANCH VALUES (13, 'NITTE', 'MANGALORE');
INSERT INTO LIBRARY_BRANCH VALUES (14, 'MANIPAL', 'UDUPI');
 
 
INSERT INTO BOOK_COPIES VALUES (10, 1, 10);
INSERT INTO BOOK_COPIES VALUES (5, 1, 11);
INSERT INTO BOOK_COPIES VALUES (2, 2, 12);
INSERT INTO BOOK_COPIES VALUES (5, 2, 13);
INSERT INTO BOOK_COPIES VALUES (7, 3, 14);
INSERT INTO BOOK_COPIES VALUES (1, 5, 10);
INSERT INTO BOOK_COPIES VALUES (3, 4, 11);
 
INSERT INTO card (CARD_NO) VALUES (10);
INSERT INTO card (CARD_NO) VALUES (14);
INSERT INTO card (CARD_NO) VALUES (13);
INSERT INTO card (CARD_NO) VALUES (11);
 
INSERT INTO BOOK_LENDING VALUES ('2017-01-01', '2017-06-01', 1, 10, 101);
INSERT INTO BOOK_LENDING VALUES ('2017-01-11', '2017-03-11', 3, 14, 101);
INSERT INTO BOOK_LENDING VALUES ('2017-02-21', '2017-04-21', 2, 13, 101);
INSERT INTO BOOK_LENDING VALUES ('2017-03-15', '2017-07-15', 4, 11, 101);
INSERT INTO BOOK_LENDING VALUES ('2017-04-12', '2017-05-12', 1, 11, 104);
 
 
 
--Queries:
 
--1.
SELECT B.BOOK_ID, B.TITLE, B.PUBLISHER_NAME, A.AUTHOR_NAME,
C.NO_OF_COPIES, L.BRANCH_ID
FROM BOOK B, BOOK_AUTHORS A, BOOK_COPIES C, LIBRARY_BRANCH L
WHERE B.BOOK_ID=A.BOOK_ID
AND B.BOOK_ID=C.BOOK_ID
AND L.BRANCH_ID=C.BRANCH_ID;
 
 
--2.
SELECT CARD_NO
FROM BOOK_LENDING
WHERE DATE_OUT BETWEEN '2017-01-01' AND '2017-07-01'
GROUP BY CARD_NO
HAVING COUNT(*) > 3;
 
 
--3.
DELETE FROM BOOK
WHERE BOOK_ID=3;
 
 
--4.
CREATE VIEW V_PUBLICATION AS
SELECT PUB_YEAR
FROM BOOK;
 
--5.
CREATE VIEW V_BOOKS AS
SELECT B.BOOK_ID, B.TITLE, C.NO_OF_COPIES
FROM BOOK B, BOOK_COPIES C, LIBRARY_BRANCH L
WHERE B.BOOK_ID=C.BOOK_ID
AND C.BRANCH_ID=L.BRANCH_ID;
 
 
--ORDERS DB:

CREATE TABLE SALESMAN (SALESMAN_ID INT(4),

NAME VARCHAR(20),

CITY VARCHAR(20),

COMMISSION VARCHAR(20),

PRIMARY KEY (SALESMAN_ID)

);
CREATE TABLE CUSTOMER (

CUSTOMER_ID INT(4),

CUST_NAME VARCHAR(20),

CITY VARCHAR(20),

GRADE INT(3),

SALESMAN_ID INT(4),

PRIMARY KEY (CUSTOMER_ID),

FOREIGN KEY (SALESMAN_ID) REFERENCES SALESMAN(SALESMAN_ID) ON DELETE SET NULL

);

 

CREATE TABLE ORDERS (

ORD_NO INT(5),

PURCHASE_AMT DECIMAL(10, 2),

ORD_DATE DATE,

PRIMARY KEY (ORD_NO),

CUSTOMER_ID INT(4),

SALESMAN_ID INT(4),

FOREIGN KEY (CUSTOMER_ID) REFERENCES CUSTOMER(CUSTOMER_ID) ON DELETE CASCADE,

FOREIGN KEY (SALESMAN_ID) REFERENCES SALESMAN(SALESMAN_ID) ON DELETE CASCADE

);

 

 

INSERT INTO SALESMAN VALUES (1000, 'JOHN', 'BANGALORE', '25 %');

INSERT INTO SALESMAN VALUES (2000, 'RAVI', 'BANGALORE', '20 %');

INSERT INTO SALESMAN VALUES (3000, 'KUMAR', 'MYSORE', '15 %');

INSERT INTO SALESMAN VALUES (4000, 'SMITH', 'DELHI', '30 %');

INSERT INTO SALESMAN VALUES (5000, 'HARSHA', 'HYDERABAD', '15 %');

 

 

 

INSERT INTO CUSTOMER VALUES (10, 'PREETHI', 'BANGALORE', 100, 1000);

INSERT INTO CUSTOMER VALUES (11, 'VIVEK', 'MANGALORE', 300, 1000);

INSERT INTO CUSTOMER VALUES (12, 'BHASKAR', 'CHENNAI', 400, 2000);

INSERT INTO CUSTOMER VALUES (13, 'CHETHAN', 'BANGALORE', 200, 2000);

INSERT INTO CUSTOMER VALUES (14, 'MAMATHA', 'BANGALORE', 400, 3000);

 

 

INSERT INTO ORDERS VALUES (50, 5000, '2017-05-04', 10, 1000);

INSERT INTO ORDERS VALUES (51, 450, '2017-01-20', 10, 2000);

INSERT INTO ORDERS VALUES (52, 1000, '2017-02-24', 13, 2000);

INSERT INTO ORDERS VALUES (53, 3500, '2017-04-13', 14, 3000);

INSERT INTO ORDERS VALUES (54, 550, '2017-03-09', 12, 2000);

 

 

--Queries:

--1

SELECT GRADE, COUNT(DISTINCT CUSTOMER_ID) 

FROM CUSTOMER 

GROUP BY GRADE 

HAVING GRADE > (SELECT AVG(GRADE) 

FROM CUSTOMER

WHERE CITY='BANGALORE');

 

 

--2

SELECT SALESMAN_ID, NAME 

FROM SALESMAN A 

WHERE 1 < (SELECT COUNT(*) 

FROM CUSTOMER 

WHERE SALESMAN_ID=A.SALESMAN_ID); 

 

 

--3

SELECT SALESMAN.SALESMAN_ID, NAME, CUST_NAME, COMMISSION 

FROM SALESMAN, CUSTOMER 

WHERE SALESMAN.CITY = CUSTOMER.CITY 

UNION 

SELECT SALESMAN_ID, NAME, 'NO MATCH', COMMISSION 

FROM SALESMAN 

WHERE NOT CITY = ANY 

(SELECT CITY 

FROM CUSTOMER) 

ORDER BY 2 DESC;

 

 

--4

CREATE VIEW ELITSALESMAN AS 

SELECT B.ORD_DATE, A.SALESMAN_ID, A.NAME 

FROM SALESMAN A, ORDERS B 

WHERE A.SALESMAN_ID = B.SALESMAN_ID 

AND B.PURCHASE_AMT=(SELECT MAX(PURCHASE_AMT) 

FROM ORDERS C 

WHERE C.ORD_DATE = 

B.ORD_DATE); 

select * from ELITSALESMAN;

 

 

--5

DELETE FROM SALESMAN 

WHERE SALESMAN_ID=1000;

SELECT * FROM SALESMAN;

--3.MOVIE
CREATE TABLE ACTOR (

  ACT_ID INT(3),

  ACT_NAME VARCHAR(20), 

  ACT_GENDER CHAR(1), 

  PRIMARY KEY (ACT_ID)

);

 

CREATE TABLE DIRECTOR (

  DIR_ID INT(3), 

  DIR_NAME VARCHAR(20), 

  DIR_PHONE VARCHAR(10), 

  PRIMARY KEY (DIR_ID)

);

 

CREATE TABLE MOVIES (

  MOV_ID INT(4),

  MOV_TITLE VARCHAR(25),

  MOV_YEAR INT(4),

  MOV_LANG VARCHAR(12),

  DIR_ID INT(3),

  PRIMARY KEY (MOV_ID),

  FOREIGN KEY (DIR_ID) REFERENCES DIRECTOR(DIR_ID)

);

 

CREATE TABLE MOVIE_CAST (

  ACT_ID INT(3),

  MOV_ID INT(4),

  ROLE VARCHAR(10),

  PRIMARY KEY (ACT_ID, MOV_ID),

  FOREIGN KEY (ACT_ID) REFERENCES ACTOR(ACT_ID), 

  FOREIGN KEY (MOV_ID) REFERENCES MOVIES(MOV_ID)

);

 

CREATE TABLE RATING (

  MOV_ID INT(4),

  REV_STARS INT, -- Assuming REV_STARS represents the number of stars given in the rating

  PRIMARY KEY (MOV_ID),

  FOREIGN KEY (MOV_ID) REFERENCES MOVIES(MOV_ID)

);

 
 

INSERT INTO ACTOR VALUES (301, 'ANUSHKA', 'F');

INSERT INTO ACTOR VALUES (302, 'PRABHAS', 'M');

INSERT INTO ACTOR VALUES (303, 'PUNITH', 'M');

INSERT INTO ACTOR VALUES (304, 'JERMY', 'M');

 

INSERT INTO DIRECTOR VALUES (60, 'RAJAMOULI', '8751611001');

INSERT INTO DIRECTOR VALUES (61, 'HITCHCOCK', '7766138911');

INSERT INTO DIRECTOR VALUES (62, 'FARAN', '9986776531');

INSERT INTO DIRECTOR VALUES (63, 'STEVEN SPIELBERG', '8989776530');

 

INSERT INTO MOVIES VALUES (1001, 'BAHUBALI-2', 2017, 'TELUGU', 60);

INSERT INTO MOVIES VALUES (1002, 'BAHUBALI-1', 2015, 'TELUGU', 60);

INSERT INTO MOVIES VALUES (1003, 'AKASH', 2008, 'KANNADA', 61);

INSERT INTO MOVIES VALUES (1004, 'WAR HORSE', 2011, 'ENGLISH', 63);

 

INSERT INTO MOVIE_CAST VALUES (301, 1002, 'HEROINE');

INSERT INTO MOVIE_CAST VALUES (302, 1001, 'HEROINE');

INSERT INTO MOVIE_CAST VALUES (303, 1003, 'HERO');

INSERT INTO MOVIE_CAST VALUES (304, 1002, 'GUEST');

INSERT INTO MOVIE_CAST VALUES (301, 1003, 'HERO');

INSERT INTO MOVIE_CAST VALUES (303, 1001, 'GUEST');

INSERT INTO MOVIE_CAST VALUES (304, 1001, 'GUEST');

 

INSERT INTO RATING VALUES (1001, 4); 

INSERT INTO RATING VALUES (1002, 2); 

INSERT INTO RATING VALUES (1003, 5);

INSERT INTO RATING VALUES (1004, 4);



-- 1. Selecting movies directed by Hitchcock

SELECT MOV_TITLE

FROM MOVIES

WHERE DIR_ID IN (SELECT DIR_ID

         FROM DIRECTOR

         WHERE DIR_NAME = 'HITCHCOCK');

 

-- 2. Selecting movies with actors appearing in multiple roles

SELECT MOV_TITLE

FROM MOVIES M, MOVIE_CAST MV

WHERE M.MOV_ID=MV.MOV_ID 

   AND ACT_ID IN (SELECT ACT_ID

           FROM MOVIE_CAST 

           GROUP BY ACT_ID 

           HAVING COUNT(DISTINCT MOV_ID) > 1)

GROUP BY MOV_TITLE 

HAVING COUNT(*) > 1;

 

-- 3. Selecting actors, movie titles, and years of movies they appeared in, excluding movies from 2000 to 2015

SELECT ACT_NAME, MOV_TITLE, MOV_YEAR 

FROM ACTOR A

JOIN MOVIE_CAST C ON A.ACT_ID=C.ACT_ID

JOIN MOVIES M ON C.MOV_ID=M.MOV_ID

WHERE M.MOV_YEAR NOT BETWEEN 2000 AND 2015;

 

-- 4. Selecting movies with their maximum ratings

SELECT MOV_TITLE, MAX(REV_STARS)

FROM MOVIES

INNER JOIN RATING USING (MOV_ID) 

GROUP BY MOV_TITLE

ORDER BY MOV_TITLE;

 

-- 5. Updating ratings to 5 for movies directed by Steven Spielberg

UPDATE RATING 

SET REV_STARS = 5

WHERE MOV_ID IN (SELECT MOV_ID 

         FROM MOVIES 

         WHERE DIR_ID IN (SELECT DIR_ID

                  FROM DIRECTOR

                  WHERE DIR_NAME = 'STEVEN SPIELBERG'));

 

SELECT * FROM RATING;

 

--4. STudentas db  

CREATE TABLE STUDENT2 (

USN VARCHAR (10) PRIMARY KEY, 

SNAME VARCHAR (25), 

ADDRESS VARCHAR (25), 

PHONE NUMBER (10), 

GENDER CHAR (1));

 

CREATE TABLE SEMSEC2 (

SSID VARCHAR (5) PRIMARY KEY, 

SEM NUMBER (2), 

SEC CHAR (1));

 

CREATE TABLE CLASS2 (

USN VARCHAR (10), 

SSID VARCHAR (5),

PRIMARY KEY (USN, SSID),

FOREIGN KEY (USN) REFERENCES STUDENT2 (USN),

FOREIGN KEY (SSID) REFERENCES SEMSEC2 (SSID));

 

CREATE TABLE SUBJECT2 (

SUBCODE VARCHAR (8), 

TITLE VARCHAR (20), 

SEM NUMBER (2), 

CREDITS NUMBER (2),

PRIMARY KEY (SUBCODE));

 

CREATE TABLE IAMARKS2 (

USN VARCHAR (10), 

SUBCODE VARCHAR (8), 

SSID VARCHAR (5), 

TEST1 NUMBER (2), 

TEST2 NUMBER (2), 

TEST3 NUMBER (2), 

FINALIA NUMBER (2),

PRIMARY KEY (USN, SUBCODE, SSID),

FOREIGN KEY (USN) REFERENCES STUDENT2 (USN),

FOREIGN KEY (SUBCODE) REFERENCES SUBJECT2 (SUBCODE),

FOREIGN KEY (SSID) REFERENCES SEMSEC2 (SSID));

 

INSERT INTO STUDENT2 VALUES ('1RN13CS020','AKSHAY','BELAGAVI', 8877881122,'M');

INSERT INTO STUDENT2 VALUES ('1RN13CS062','SANDHYA','BENGALURU', 7722829912,'F');

INSERT INTO STUDENT2 VALUES ('1RN13CS091','TEESHA','BENGALURU', 7712312312,'F');

INSERT INTO STUDENT2 VALUES ('1RN13CS066','SUPRIYA','MANGALURU', 8877881122,'F');

INSERT INTO STUDENT2 VALUES ('1RN14CS010','ABHAY','BENGALURU', 9900211201,'M');

INSERT INTO STUDENT2 VALUES ('1RN14CS032','BHASKAR','BENGALURU', 9923211099,'M');

 

INSERT INTO STUDENT2 VALUES ('1RN14CS025','ASMI','BENGALURU', 7894737377,'F');

INSERT INTO STUDENT2 VALUES ('1RN15CS011','AJAY','TUMKUR', 9845091341,'M');

INSERT INTO STUDENT2 VALUES ('1RN15CS029','CHITRA','DAVANGERE', 7696772121,'F');

INSERT INTO STUDENT2 VALUES ('1RN15CS045','JEEVA','BELLARY', 9944850121,'M');

INSERT INTO STUDENT2 VALUES ('1RN15CS091','SANTOSH','MANGALURU', 8812332201,'M');

INSERT INTO STUDENT2 VALUES ('1RN16CS045','ISMAIL','KALBURGI', 9900232201,'M');

INSERT INTO STUDENT2 VALUES ('1RN16CS088','SAMEERA','SHIMOGA', 9905542212,'F');

INSERT INTO STUDENT2 VALUES ('1RN16CS122','VINAYAKA','CHIKAMAGALUR', 8800880011,'M');

 

 

INSERT INTO SEMSEC2 VALUES ('CSE8A', 8,'A');

INSERT INTO SEMSEC2 VALUES ('CSE8B', 8,'B');

INSERT INTO SEMSEC2 VALUES ('CSE8C', 8,'C');

 

INSERT INTO SEMSEC2 VALUES ('CSE7A', 7,’A’);

INSERT INTO SEMSEC2 VALUES ('CSE7B', 7,'B');

INSERT INTO SEMSEC2 VALUES ('CSE7C', 7,'C');

 

INSERT INTO SEMSEC2 VALUES ('CSE6A', 6,'A');

INSERT INTO SEMSEC2 VALUES ('CSE6B', 6,'B');

INSERT INTO SEMSEC2 VALUES ('CSE6C’, 6,'C');

 

INSERT INTO SEMSEC2 VALUES ('CSE5A', 5,'A');

INSERT INTO SEMSEC2 VALUES ('CSE5B', 5,'B');

INSERT INTO SEMSEC2 VALUES ('CSE5C', 5,'C');

 

INSERT INTO SEMSEC2 VALUES ('CSE4A', 4,'A');

INSERT INTO SEMSEC2 VALUES ('CSE4B', 4,'B');

INSERT INTO SEMSEC2 VALUES ('CSE4C', 4,'C');

 

INSERT INTO SEMSEC2 VALUES ('CSE3A', 3,'A');

INSERT INTO SEMSEC2 VALUES ('CSE3B', 3,'B');

INSERT INTO SEMSEC2 VALUES ('CSE3C', 3,'C');

 

INSERT INTO SEMSEC2 VALUES ('CSE2A', 2,’A’);

INSERT INTO SEMSEC2 VALUES ('CSE2B’, 2,'B');

INSERT INTO SEMSEC2 VALUES ('CSE2C', 2,'C');

 

INSERT INTO SEMSEC2 VALUES ('CSE1A', 1,'A');

INSERT INTO SEMSEC2 VALUES ('CSE1B', 1,'B');

INSERT INTO SEMSEC2 VALUES ('CSE1C', 1,'C');

 

INSERT INTO CLASS2 VALUES ('1RN13CS020','CSE8A');

INSERT INTO CLASS2 VALUES ('1RN13CS062','CSE8A');

INSERT INTO CLASS2 VALUES ('1RN13CS066','CSE8B');

INSERT INTO CLASS2 VALUES ('1RN13CS091','CSE8C');

INSERT INTO CLASS2 VALUES ('1RN14CS010','CSE7A');

INSERT INTO CLASS2 VALUES ('1RN14CS025','CSE7A');

INSERT INTO CLASS2 VALUES ('1RN14CS032','CSE7A');

INSERT INTO CLASS2 VALUES ('1RN15CS011','CSE4A');

INSERT INTO CLASS2 VALUES ('1RN15CS029','CSE4A');

INSERT INTO CLASS2 VALUES ('1RN15CS045','CSE4B');

INSERT INTO CLASS2 VALUES ('1RN15CS091','CSE4C');

INSERT INTO CLASS2 VALUES ('1RN16CS045','CSE3A');

INSERT INTO CLASS2 VALUES ('1RN16CS088','CSE3B');

INSERT INTO CLASS2 VALUES ('1RN16CS122','CSE3C');

 

 

INSERT INTO SUBJECT2 VALUES ('10CS81','ACA', 8, 4);

INSERT INTO SUBJECT2 VALUES ('10CS82','SSM', 8, 4);

INSERT INTO SUBJECT2 VALUES ('10CS83','NM', 8, 4);

INSERT INTO SUBJECT2 VALUES ('10CS84','CC', 8, 4);

INSERT INTO SUBJECT2 VALUES ('10CS85','PW', 8, 4);

 

INSERT INTO SUBJECT2 VALUES ('10CS71','OOAD', 7, 4);

INSERT INTO SUBJECT2 VALUES ('10CS72','ECS', 7, 4);

INSERT INTO SUBJECT2 VALUES ('10CS73','PTW', 7, 4);

INSERT INTO SUBJECT2 VALUES ('10CS74','DWDM', 7, 4);

INSERT INTO SUBJECT2 VALUES ('10CS75','JAVA', 7, 4);

INSERT INTO SUBJECT2 VALUES ('10CS76','SAN', 7, 4);

 

INSERT INTO SUBJECT2 VALUES ('15CS51', 'ME', 5, 4);

INSERT INTO SUBJECT2 VALUES ('15CS52','CN', 5, 4);

INSERT INTO SUBJECT2 VALUES ('15CS53','DBMS', 5, 4);

INSERT INTO SUBJECT2 VALUES ('15CS54','ATC', 5, 4);

INSERT INTO SUBJECT2 VALUES ('15CS55','JAVA', 5, 3);

INSERT INTO SUBJECT2 VALUES ('15CS56','AI', 5, 3);

 

INSERT INTO SUBJECT2 VALUES ('15CS41','M4', 4, 4);

INSERT INTO SUBJECT2 VALUES ('15CS42','SE', 4, 4);

INSERT INTO SUBJECT2 VALUES ('15CS43','DAA', 4, 4);

INSERT INTO SUBJECT2 VALUES ('15CS44','MPMC', 4, 4);

INSERT INTO SUBJECT2 VALUES ('15CS45','OOC', 4, 3);

INSERT INTO SUBJECT2 VALUES ('15CS46','DC', 4, 3);

 

INSERT INTO SUBJECT2 VALUES ('15CS31','M3', 3, 4);

INSERT INTO SUBJECT2 VALUES ('15CS32','ADE', 3, 4);

INSERT INTO SUBJECT2 VALUES ('15CS33','DSA', 3, 4);

INSERT INTO SUBJECT2 VALUES ('15CS34','CO', 3, 4);

INSERT INTO SUBJECT2 VALUES ('15CS35','USP', 3, 3);

INSERT INTO SUBJECT2 VALUES ('15CS36','DMS', 3, 3);

 

INSERT INTO IAMARKS2 (USN, SUBCODE, SSID, TEST1, TEST2, TEST3) VALUES 

('1RN13CS091','10CS81','CSE8C', 15, 16, 18);

INSERT INTO IAMARKS2 (USN, SUBCODE, SSID, TEST1, TEST2, TEST3) VALUES 

('1RN13CS091','10CS82','CSE8C', 12, 19, 14);

INSERT INTO IAMARKS2 (USN, SUBCODE, SSID, TEST1, TEST2, TEST3) VALUES 

('1RN13CS091','10CS83','CSE8C', 19, 15, 20);

INSERT INTO IAMARKS2 (USN, SUBCODE, SSID, TEST1, TEST2, TEST3) VALUES 

('1RN13CS091','10CS84','CSE8C', 20, 16, 19);

INSERT INTO IAMARKS2 (USN, SUBCODE, SSID, TEST1, TEST2, TEST3) VALUES 

('1RN13CS091','10CS85','CSE8C', 15, 15, 12);

 

 

 

SELECT S.*, SS.SEM, SS.SEC 

FROM STUDENT2 S, SEMSEC2 SS, CLASS2 C

WHERE S.USN = C.USN AND 

SS.SSID = C.SSID AND

SS.SEM = 4 AND

SS.SEc='C';

 

SELECT SS.SEM, SS.SEC, S.GENDER, COUNT (S.GENDER) AS COUNT 

FROM STUDENT1 S, SEMSEC2 SS, CLASS2 C 

WHERE S.USN = C.USN AND

SS.SSID = C.SSID

GROUP BY SS.SEM, SS.SEC, S.GENDER

ORDER BY SEM;

 

CREATE VIEW TU_TEST1_MARKS_VIEW 

AS

SELECT TEST1, SUBCODE

FROM IAMARKS2

WHERE USN = '1RN13CS091';

 

 

CREATE OR REPLACE PROCEDURE AVGMARKS 

IS

CURSOR C_IAMARKS2 IS 

SELECT GREATEST(TEST1,TEST2) AS A, GREATEST(TEST1,TEST3) AS B, 

GREATEST(TEST3,TEST2) AS C 

FROM IAMARKS2

WHERE FINALIA IS NULL 

FOR UPDATE; 

 C_A NUMBER;

 C_B NUMBER;

 C_C NUMBER;

 C_SM NUMBER;

 C_AV NUMBER;

BEGIN 

 OPEN C_IAMARKS2; 

 LOOP 

 FETCH C_IAMARKS2 INTO C_A, C_B, C_C; 

 EXIT WHEN C_IAMARKS2%NOTFOUND; 

 --DBMS_OUTPUT.PUT_LINE(C_A || ' ' || C_B || ' ' || C_C); 

 IF (C_A != C_B) THEN 

C_SM:=C_A+C_B;

 ELSE

C_SM:=C_A+C_C;

 END IF;

 C_AV:=C_SM/2;

 --DBMS_OUTPUT.PUT_LINE('SUM = '||C_SM);

 --DBMS_OUTPUT.PUT_LINE('AVERAGE = '||C_AV);

 UPDATE IAMARKS2 SET FINALIA=C_AV WHERE CURRENT OF C_IAMARKS2;

 END LOOP; 

 CLOSE C_IAMARKS2; 

END;

/

 

BEGIN

AVGMARKS; 

END;

/

 

 

 

SELECT S.USN,S.SNAME,S.ADDRESS,S.PHONE,S.GENDER,

 (CASE 

 WHEN IA.FINALIA BETWEEN 17 AND 20 THEN 'OUTSTANDING'

 WHEN IA.FINALIA BETWEEN 12 AND 16 THEN 'AVERAGE'

 ELSE 'WEAK'

 END) AS CAT

FROM STUDENT2 S, SEMSEC2 SS, IAMARKS2 IA, SUBJECT2 SUB

WHERE S.USN = IA.USN AND 

SS.SSID = IA.SSID AND

SUB.SUBCODE = IA.SUBCODE AND

SUB.SEM = 8;

 

 

 

 

 

--5.Emoloyee

CREATE TABLE DEPARTMENT

(DNO VARCHAR2 (20) PRIMARY KEY,

DNAME VARCHAR2 (20),

MGRSTARTDATE DATE);

 

CREATE TABLE EMPLOYEE

(SSN VARCHAR2 (20) PRIMARY KEY,

FNAME VARCHAR2 (20),

LNAME VARCHAR2 (20),

ADDRESS VARCHAR2 (20),

SEX CHAR (1),

SALARY INTEGER,

SUPERSSN REFERENCES EMPLOYEE (SSN),

DNO REFERENCES DEPARTMENT (DNO));

 

ALTER TABLE DEPARTMENT

ADD MGRSSN REFERENCES EMPLOYEE (SSN);

 

CREATE TABLE DLOCATION

(DLOC VARCHAR2 (20),

DNO REFERENCES DEPARTMENT (DNO),

PRIMARY KEY (DNO, DLOC));

 

CREATE TABLE PROJECT

(PNO INTEGER PRIMARY KEY,

PNAME VARCHAR2 (20),

PLOCATION VARCHAR2 (20),

DNO REFERENCES DEPARTMENT (DNO));

 

 

CREATE TABLE WORKS_ON

(HOURS NUMBER (2),

SSN REFERENCES EMPLOYEE (SSN),

PNO REFERENCES PROJECT(PNO),

PRIMARY KEY (SSN, PNO));

 

INSERT INTO EMPLOYEE (SSN, FNAME, LNAME, ADDRESS, SEX, SALARY) VALUES 

('RNSECE01','JOHN','SCOTT','BANGALORE','M', 450000);

INSERT INTO EMPLOYEE (SSN, FNAME, LNAME, ADDRESS, SEX, SALARY) VALUES 

('RNSCSE01','JAMES','SMITH','BANGALORE','M', 500000);

INSERT INTO EMPLOYEE (SSN, FNAME, LNAME, ADDRESS, SEX, SALARY) VALUES 

('RNSCSE02','HEARN','BAKER','BANGALORE','M', 700000);

INSERT INTO EMPLOYEE (SSN, FNAME, LNAME, ADDRESS, SEX, SALARY) VALUES 

('RNSCSE03','EDWARD','SCOTT','MYSORE','M', 500000);

INSERT INTO EMPLOYEE (SSN, FNAME, LNAME, ADDRESS, SEX, SALARY) VALUES 

('RNSCSE04','PAVAN','HEGDE','MANGALORE','M', 650000);

INSERT INTO EMPLOYEE (SSN, FNAME, LNAME, ADDRESS, SEX, SALARY) VALUES 

('RNSCSE05','GIRISH','MALYA','MYSORE','M', 450000);

 

INSERT INTO EMPLOYEE (SSN, FNAME, LNAME, ADDRESS, SEX, SALARY) VALUES 

('RNSCSE06','NEHA','SN','BANGALORE','F', 800000);

INSERT INTO EMPLOYEE (SSN, FNAME, LNAME, ADDRESS, SEX, SALARY) VALUES 

('RNSACC01','AHANA','K','MANGALORE','F', 350000);

INSERT INTO EMPLOYEE (SSN, FNAME, LNAME, ADDRESS, SEX, SALARY) VALUES 

('RNSACC02','SANTHOSH','KUMAR','MANGALORE','M', 300000);

INSERT INTO EMPLOYEE (SSN, FNAME, LNAME, ADDRESS, SEX, SALARY) VALUES 

('RNSISE01','VEENA','M','MYSORE','M', 600000);

INSERT INTO EMPLOYEE (SSN, FNAME, LNAME, ADDRESS, SEX, SALARY) VALUES 

('RNSIT01','NAGESH','HR','BANGALORE','M', 500000);

 

 

INSERT INTO DEPARTMENT VALUES ('1','ACCOUNTS','01-JAN-01','RNSACC02');

INSERT INTO DEPARTMENT VALUES ('2','IT','01-AUG-16','RNSIT01');

INSERT INTO DEPARTMENT VALUES ('3','ECE','01-JUN-08','RNSECE01');

INSERT INTO DEPARTMENT VALUES ('4','ISE','01-AUG-15','RNSISE01');

INSERT INTO DEPARTMENT VALUES ('5','CSE','01-JUN-02','RNSCSE05');

 

UPDATE EMPLOYEE SET

SUPERSSN=NULL, DNO='3'

WHERE SSN='RNSECE01';

 

UPDATE EMPLOYEE SET

SUPERSSN=’RNSCSE02’, DNO=’5’

WHERE SSN=’RNSCSE01’;

 

UPDATE EMPLOYEE SET

SUPERSSN=’RNSCSE03’, DNO=’5’

WHERE SSN=’RNSCSE02’;

 

UPDATE EMPLOYEE SET

SUPERSSN=’RNSCSE04’, DNO=’5’

WHERE SSN=’RNSCSE03’;

 

UPDATE EMPLOYEE SET

DNO=’5’, SUPERSSN=’RNSCSE05’

WHERE SSN=’RNSCSE04’;

 

UPDATE EMPLOYEE SET

DNO=’5’, SUPERSSN=’RNSCSE06’

WHERE SSN=’RNSCSE05’;

 

UPDATE EMPLOYEE SET

DNO=’5’, SUPERSSN=NULL

WHERE SSN=’RNSCSE06’;

 

UPDATE EMPLOYEE SET

DNO=’1’, SUPERSSN=’RNSACC02’

WHERE SSN=’RNSACC01’;

 

UPDATE EMPLOYEE SET

DNO=’1’, SUPERSSN=NULL

WHERE SSN=’RNSACC02’;

 

UPDATE EMPLOYEE SET

DNO=’4’, SUPERSSN=NULL

WHERE SSN=’RNSISE01’;

 

UPDATE EMPLOYEE SET

DNO=’2’, SUPERSSN=NULL

WHERE SSN=’RNSIT01’;

 

INSERT INTO DLOCATION VALUES ('BANGALORE', '1');

INSERT INTO DLOCATION VALUES ('BANGALORE', '2');

INSERT INTO DLOCATION VALUES ('BANGALORE', '3');

INSERT INTO DLOCATION VALUES ('MANGALORE', '4');

INSERT INTO DLOCATION VALUES ('MANGALORE', '5');

 

INSERT INTO PROJECT VALUES (100,'IOT','BANGALORE','5');

INSERT INTO PROJECT VALUES (101,'CLOUD','BANGALORE','5');

INSERT INTO PROJECT VALUES (102,'BIGDATA','BANGALORE','5');

INSERT INTO PROJECT VALUES (103,'SENSORS','BANGALORE','3');

INSERT INTO PROJECT VALUES (104,'BANK MANAGEMENT','BANGALORE','1');

INSERT INTO PROJECT VALUES (105,'SALARY MANAGEMENT','BANGALORE','1');

INSERT INTO PROJECT VALUES (106,'OPENSTACK','BANGALORE','4');

INSERT INTO PROJECT VALUES (107,'SMART CITY','BANGALORE','2');

 

INSERT INTO WORKS_ON VALUES (4, 'RNSCSE01', 100);

INSERT INTO WORKS_ON VALUES (6, 'RNSCSE01', 101);

INSERT INTO WORKS_ON VALUES (8, 'RNSCSE01', 102);

INSERT INTO WORKS_ON VALUES (10, 'RNSCSE02', 100);

INSERT INTO WORKS_ON VALUES (3, 'RNSCSE04', 100);

INSERT INTO WORKS_ON VALUES (4, 'RNSCSE05', 101);

INSERT INTO WORKS_ON VALUES (5, 'RNSCSE06', 102);

INSERT INTO WORKS_ON VALUES (6, 'RNSCSE03', 102);

INSERT INTO WORKS_ON VALUES (7, 'RNSECE01', 103);

INSERT INTO WORKS_ON VALUES (5, 'RNSACC01', 104);

INSERT INTO WORKS_ON VALUES (6, 'RNSACC02', 105);

INSERT INTO WORKS_ON VALUES (4, 'RNSISE01', 106);

INSERT INTO WORKS_ON VALUES (10, 'RNSIT01', 107);

 

(SELECT DISTINCT P.PNO

FROM PROJECT P, DEPARTMENT D, EMPLOYEE E

WHERE E.DNO=D.DNO

AND D.MGRSSN=E.SSN

AND E.LNAME=’SCOTT’)

UNION

(SELECT DISTINCT P1.PNO

FROM PROJECT P1, WORKS_ON W, EMPLOYEE E1

WHERE P1.PNO=W.PNO

AND E1.SSN=W.SSN

AND E1.LNAME=’SCOTT’);

 

SELECT E.FNAME, E.LNAME, 1.1*E.SALARY AS INCR_SAL

FROM EMPLOYEE E, WORKS_ON W, PROJECT P

WHERE E.SSN=W.SSN

AND W.PNO=P.PNO

AND P.PNAME=’IOT’;

 

SELECT SUM (E.SALARY), MAX (E.SALARY), MIN (E.SALARY), AVG 

(E.SALARY)

FROM EMPLOYEE E, DEPARTMENT D

WHERE E.DNO=D.DNO

AND D.DNAME=’ACCOUNTS’;

 

SELECT LNAME, FNAME, DNO

FROM EMPLOYEE

WHERE NOT EXISTS (SELECT * 

 FROM WORKS_ON B

 WHERE (B.PNO IN(SELECT P.PNO

 FROM PROJECT P

 WHERE P.DNO=’5’)

 AND

 NOT EXISTS (SELECT * 

FROM WORKS_ON C

WHERE C.SSN=SSN

AND C.PNO=B.PNO)));

 

 

 

SELECT D.DNO, COUNT (*)

FROM DEPARTMENT D, EMPLOYEE E

WHERE D.DNO=E.DNO

AND E.SALARY>600000 

AND D.DNO IN (SELECT E1.DNO

FROM EMPLOYEE E1

GROUP BY E1.DNO

HAVING COUNT (*)>5)

GROUP BY D.DNO;
